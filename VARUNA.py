import math
from pandas import read_excel, notnull
from tabulate import tabulate

PARA = ['Electric Conductivity(mS/cm)', 'Dissolved Oxygen(mg/L)', 'pH', 'Chloride ion(mg/L)', 
        'Color(NTU)', 'Turbidity(NTU)', 'Total Dissolved Solids(mg/L)', 'Total Suspended Solids(mg/L)', 
        'NH4-N(mg/L)', 'NH3-N(mg/L)', 'Total Coliform(CFU/1000ml)', 'Fecal Coliform(CFU/1000ml)', 
        'Chemical Oxygen Demand(mg/L)', 'Biological Oxygen Demand(mg/L)', 'Chlorophyll(mg/L)', 'Fe(mg/L)', 
        'Pb(mg/L)', 'Cd(mg/L)', 'Cr(mg/L)', 'Zn(mg/L)', 'Hg(mg/L)', 'Oil & Grease(mg/L)', 'Pesticides(mg/L)']

S_N = [2.25, 6, 8.5, 1000, 15, 5, 1000, 100, 0.3, 0.3, 5000, 5000, 
       250, 3, 0.01, 1, 0.01, 0.003, 0.05, 5, 0.001, 0.01, 0.00004]

V_I = [0, 14.6, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
n = len(PARA)
m = 0

Para_NSF = ['pH', 'BOD', 'DO', 'TDS', 'Turbidity', 'Temperature', 'Nitrates', 'Phosphorus', 'Fecal Coliform']
p = len(Para_NSF)

print("Choose input method for WQI, CWQI & NSFWQI:\n 1.Manual Input 2.Excel Input")
Opt = input('Choose:')

if Opt == '2':
    df = read_excel('data.xlsx', sheet_name=0, header=None)
    data_list = []
    Vn_data = []
    Nsf_data  =[]
    for row in df.values:
        row_list = []
        for cell in row:
            if notnull(cell):
                row_list.append(cell)
        if len(row_list) != 0:
            data_list.append(row_list)

    for i in range(len(data_list)):
        if data_list[i][0].upper() == 'NSFWQI':
            Vn_data = data_list[2:i]
            Nsf_data = data_list[i+2:]
            break
        
    numbers = len(Vn_data[1]) - 1
    Vn = [[-1.0] * numbers for _ in range(n)]
    for para in PARA:
        for data in Vn_data:
            if data[0].upper() == para.upper() and len(data) > 1:
                m += 1
                Vn[PARA.index(para)] = data[1:]

    nsf_num = len(Nsf_data[1]) - 1
    Vn_NSF = [[-1.0] * nsf_num for _ in range(p)]
    for para in Para_NSF:
        for data in Nsf_data:
            if data[0].upper() == para.upper() and len(data) > 1:
                m += 1
                Vn_NSF[Para_NSF.index(para)] = data[1:]

elif Opt == '1':
    numbers = int(input('Enter Numbers of Tests You Had Done: '))
    Vn = [[-1.0] * numbers for _ in range(n)]
    for i in range (n):
        print('Enter The value of ' + PARA[i] + ':')
        for j in range(numbers):
            In = input(str(j + 1) + ':')
            try:
                Vn[i][j] = float(In)
            except ValueError:
                break
        if Vn[i][0] != -1:
            m += 1


def WQI ():
    Output = []
    wqi = []
    # Finding K
    S = 0
    for i in range(n):
        if Vn[i][0] != -1:
            S += 1/S_N[i]
    K = 1 / S

    for i in range(numbers):
        WI = ['Wi']
        WQI = ['WQI']
        WQ = ['Water Quality']
        G = ['Grade']
        # Finding WQI
        qiwi = 0
        wi = 0
        for j in range (n):
            if Vn[j][i] != -1:
                Wn = K / S_N[j]
                qn = ((Vn[j][i] - V_I[j]) / (S_N[j] - V_I[j])) * 100
                qiwi += qn * Wn
                wi += Wn
                WI.append(str(Wn))
                WQI.append("")
                WQ.append("")
                G.append("")

        wqi.append(qiwi / wi)
        e = math.ceil(len(WI)/2)
        WQI[e] = str(wqi[i])


        #print("WQI = " + str(wqi[i]))

        # Comparison
        if wqi[i] >= 0 and wqi[i] <= 25:
            WQ[e] = 'Excellent'
            G[e] = 'A'
            #print ("The Quality of the water is Excellent and it's grade is A")
        elif wqi[i] > 25 and wqi[i] <= 50:
            WQ[e] = 'Good'
            G[e] = 'B'
            #print ("The Quality of the water is Good and it's grade is B")
        elif wqi[i] > 50 and wqi[i] <= 75:
            WQ[e] = 'Poor'
            G[e] = 'C'
            #print ("The Quality of the water is Poor and it's grade is C")
        elif wqi[i] > 75 and wqi[i] <= 100:
            WQ[e] = 'Very Bad'
            G[e] = 'D'
           # print("The Quality of the water is Very Bad and it's grade is D")
        else:
            WQ[e] ='Unfit for Drinking'
            G[e] = 'E'
           # print("The Quality of the water is Unfit for Drinking and it's grade is E")
        Out = list(zip(WI, WQI, WQ, G))
        Output.append(Out)
    #print(wqi)
    #print(Output)
    return Output


# CWQI TEST
def CWQI():
    f1 = 0
    f2 = 0
    excursion = 0
    for i in range (n):
        if Vn[i][0] != -1:
            f1_bool = False
            for j in Vn[i]:
                if PARA[i] == 'Dissolved Oxygen':
                    if j < S_N[i]:
                        f2 += 1
                        f1_bool = True
                        excursion += ((S_N[i] / j) - 1)
                elif PARA[i] == 'pH':
                    if j < 6.5:
                        f2 += 1
                        f1_bool = True
                        excursion += ((S_N[i] / j) - 1)
                    elif j > 8.5:
                        f2 += 1
                        f1_bool = True
                        excursion += ((j / S_N[i]) - 1)

                else:
                    if j > S_N[i]:
                        f2 += 1
                        f1_bool = True
                        excursion += ((j / S_N[i]) - 1)
            if f1_bool:
                f1 += 1

    F1 = (f1 / m) * 100
    F2 =  (f2 /  (m * numbers)) * 100
    nse = excursion / (m * numbers)
    F3 = nse / ((0.01 * nse )+ 0.01)
    CWQI = 100 - (math.sqrt(F1**2 + F2**2 + F3**2) / 1.732)

    #print("CWQi = " + str(CWQI))
    if CWQI >= 95 and CWQI <= 100:
        G = 'Excellent'
        #print ("The Quality of the water is Excellent ")
    elif CWQI >= 80 and CWQI < 95:
        G = 'Good'
        #print ("The Quality of the water is Good ")
    elif CWQI >= 65 and CWQI < 80:
        G = 'Fair'
        #print ("The Quality of the water is Fair ")
    elif CWQI >= 45 and CWQI <= 65:
        G = 'Marginal'
        #print("The Quality of the water is Marginal")
    else:
        G = 'Poor'
        #print("The Quality of the water is Poor")

    Output = [['CWQi', 'Water Quality'], [str(CWQI), G]]
    return Output

def NSF():
    Wi = [0.12, 0.1, 0.17, 0.08,0.08,0.1, 0.1,0.1, 0.15]

    NSF_pH = [[2.30181082812661, 1.62271191278459],
    [2.50301866091339, 3.24542382556919],
    [2.68410515778936, 3.44826977861786],
    [2.94567515620147, 4.66530835584004],
    [3.06639948745211, 5.07098169140246],
    [3.26760547813179, 5.47667359749981],
    [3.32796764375711, 5.47667359749981],
    [3.5492968124547, 6.89653955723573],
    [3.83098630467051, 7.91075075194417],
    [4.09255630308261, 9.93913600029118],
    [4.23340012813697, 11.9675398191731],
    [4.43460796092375, 14.1987803058362],
    [4.5754536280852, 16.0243381716695],
    [4.69617795933585, 19.2697712825062],
    [4.8370217843902, 21.5010117691693],
    [4.95774611564085, 23.3265696350026],
    [5.0784704468915, 24.746444880006],
    [5.19919477814214, 26.7748486988879],
    [5.29979961558908, 30.2231184775058],
    [5.42052394683973, 33.06287825278],
    [5.50100560626876, 34.8884361186133],
    [5.6016104437157, 38.13386922945],
    [5.64185127343022, 40.5679463838943],
    [5.70221343905554, 43.6105428269498],
    [5.78269694059167, 46.450302602224],
    [5.88329993593151, 48.6815430888872],
    [5.92354076564602, 52.129812867505],
    [6.04426509689667, 54.3610533541682],
    [6.1247485984328, 57.4036497972236],
    [6.18511076405813, 61.0547655288902],
    [6.24547292968345, 64.0973619719456],
    [6.32595643121959, 66.1257565055601],
    [6.40643809064861, 68.5598336600045],
    [6.46680025627394, 70.7910741466676],
    [6.52716242189926, 73.0223146333308],
    [6.54728375781007, 75.2535458347265],
    [6.60764592343539, 78.7018248986118],
    [6.70824891877523, 81.1359020530562],
    [6.76861108440055, 84.1784984961116],
    [6.84909458593669, 86.612575650556],
    [6.94969758127652, 89.6551720936114],
    [7.1307840781525, 91.6835712698596],
    [7.31187057502847, 92.0892492480558],
    [7.43259490627911, 91.8864125802746],
    [7.55331923752976, 90.6693740030524],
    [7.75452707031654, 88.8438161372191],
    [7.895372737478, 86.8154123183372],
    [8.01609706872865, 84.9898544525039],
    [8.09657872815767, 82.3529406302783],
    [8.19718356560462, 79.918863475834],
    [8.33802739065897, 77.4847863213896],
    [8.4185108921951, 75.0507091669453],
    [8.47887305782042, 72.6166320125009],
    [8.53923522344575, 70.7910741466676],
    [8.55935655935656, 68.9655162808344],
    [8.61971872498188, 66.7342757941712],
    [8.6800808906072, 64.5030445927755],
    [8.74044305623253, 63.2860060155533],
    [8.82092471566155, 60.6490829080603],
    [8.88128688128688, 58.6206883744458],
    [8.9215295531085, 56.3894478877827],
    [8.98189171873382, 54.3610533541682],
    [9.02213254844834, 51.9269761997238],
    [9.10261604998447, 49.8985816661093],
    [9.14285687969898, 47.464504511665],
    [9.22334038123511, 45.2332640250018],
    [9.28370254686044, 42.1906675819464],
    [9.34406471248576, 40.1622730483319],
    [9.38430554220028, 38.3367151824986],
    [9.46478904373641, 36.1054746958355],
    [9.50502987345092, 34.077080162221],
    [9.56539203907624, 32.0486763433391],
    [9.62575420470157, 30.0202818097246],
    [9.7062377062377, 27.383367987499],
    [9.76659987186303, 25.9634834572282],
    [9.86720286720286, 23.7322522558325],
    [9.92756503282819, 21.5010117691693],
    [10.028168028168, 19.2697712825062],
    [10.1488923594186, 16.4300207924994],
    [10.2696166906693, 13.995943638055],
    [10.4708245234561, 11.7646938661244],
    [10.651911020332, 9.12778932916635],
    [10.832997517208, 8.31642408750658],
    [11.014084014084, 6.89653955723573],
    [11.1146870094238, 5.67950098001355],
    [11.3158948422106, 4.86815430888872],
    [11.5573435047119, 3.65111573166654],
    [11.718308665677, 3.04259644305545],
    [11.8390329969277, 1.82555786583327],
    [11.9798786640891, 1.62271191278459]]

    NSF_BOD = [[0.270270270270269, 98.1818181818181],
    [0.320270270270269, 96.1616146203243],      
    [0.360358985694682, 94.1414110588305],      
    [0.460358985694682, 92.9292898467092],      
    [0.540540540540539, 92.1212121212121],      
    [0.630629255964952, 90.7070645419034],      
    [0.720717971389356, 89.0909090909091],      
    [0.820717971389356, 87.8787878787878],      
    [0.99098824165963, 85.8585796934185],       
    [1.17116979650549, 83.6363636363636],       
    [1.2612585119299, 82.6262595436789],        
    [1.3612585119299, 80.6060606060606],        
    [1.53152878220017, 79.3939393939393],       
    [1.71171033704603, 77.5757575757575],       
    [2.07206932274071, 75.1515151515151],       
    [2.27206932274071, 73.3333333333333],       
    [2.43243243243243, 71.9191857540246],       
    [2.52252114785684, 69.6969696969697],       
    [2.79279141812711, 68.686865604285],        
    [2.97297297297297, 67.0707009055397],       
    [3.15315040382179, 64.8484848484848],       
    [3.24324324324324, 63.6363636363636],       
    [3.60360222893792, 61.8181818181818],       
    [3.78378378378378, 60.6060606060606],       
    [4.05405405405405, 59.5959565133759],       
    [4.23423148490286, 57.5757575757575],       
    [4.50450175517313, 55.7575757575757],       
    [4.86486486486486, 53.9393939393939],       
    [5.04504229571368, 52.9292898467092],       
    [5.22522385055954, 51.5151515151515],       
    [5.49549412082981, 50.1010039358428],       
    [5.94594594594595, 48.4848484848484],       
    [6.21621621621621, 46.6666666666666],       
    [6.57657932590794, 44.8484848484848],       
    [7.02702702702703, 43.4343372691761],       
    [7.38739013671875, 41.4141383315577],       
    [7.65766040698902, 39.1919130267519],       
    [7.92793067725929, 37.9797918146306],       
    [8.37837837837837, 36.5656534830729],       
    [8.82882607949746, 35.3535322709517],       
    [9.369366620038, 33.5353504527698],
    [9.90990716057854, 31.5151515151515],       
    [10.450447701119, 30.1010039358428],        
    [11.1711739205025, 28.2828221176609],       
    [11.6216216216216, 26.4646402994791],       
    [12.4324324324324, 24.6464584812973],       
    [12.8828801335515, 23.6363636363636],       
    [13.5135135135135, 21.8181818181818],       
    [14.1441468934755, 21.0100948449337],       
    [14.7747720254434, 19.5959565133759],       
    [15.5855828362542, 17.7777746951941],       
    [16.1261233767947, 16.5656534830729],       
    [17.1171198664484, 15.1515151515151],       
    [17.9279306772592, 13.5353412050189],       
    [18.7387414880701, 12.7272727272727],       
    [19.6396368903082, 11.5151515151515],       
    [20.7207179713893, 10.5050381747159],       
    [21.6216216216216, 9.8989775686553],        
    [22.4324324324324, 8.88888272372159],
    [22.7027027027027, 8.68685635653409],       
    [23.6036063529349, 7.87878787878787],       
    [24.684687434016, 7.47473514441287],        
    [25.6756756756756, 6.66666666666666],       
    [26.6666639173353, 6.66666666666666],       
    [27.8378378378378, 5.85857969341856],       
    [28.6486486486486, 5.65655332623106]]

    NSF_DO = [[2.21730174188729, 4.78359850689811],
    [4.87805571217527, 5.92256443557302],
    [8.42571413926473, 7.06150950941347],
    [11.0864681095527, 8.88383622594231],
    [15.9645441216697, 10.7061629424711],
    [18.6252980919577, 12.5284792315827],
    [20.8425795339031, 14.3508059481115],
    [24.3902379609926, 16.6287065232097],
    [26.6075600028216, 18.6788201690232],
    [29.2683139731096, 21.1845181008232],
    [31.4855954150551, 22.7790474606501],
    [33.2594449285416, 24.3735872478943],
    [36.8071033556311, 27.107072108979],
    [40.7982343110631, 30.2961308286329],
    [43.4589882813511, 32.8018287604329],
    [46.1197422516391, 35.7631005508022],
    [48.3370236935845, 38.7243827685887],
    [50.5543457354136, 41.0022833436868],
    [53.2150997057016, 43.9635551340561],
    [55.432381147647, 46.6970399951408],
    [56.3192856044485, 49.2027379269408],
    [58.093135117935, 51.9362227880254],
    [58.5366076462775, 53.7585495045542],
    [59.8669846314216, 57.4031925101947],
    [62.084266073367, 60.1366773712793],
    [62.5277386017095, 63.0979491616486],
    [64.3015475153125, 65.1480628074621],
    [65.6319245004565, 67.1981764532756],
    [68.2926784707445, 70.6150325296314],
    [70.5100005125735, 73.3485173907161],
    [72.727281954519, 76.0820022518007],
    [74.5011314680055, 78.8154871128853],
    [76.7184129099509, 81.54897197397],
    [79.3791668802389, 84.2824568350546],
    [81.5964483221844, 86.7881547668546],
    [85.1441473491574, 89.7494265572239],
    [88.6918057762469, 92.4829114183086],
    [91.3525597465349, 94.3052381348374],
    [94.9002181736243, 97.038722995922],
    [98.4479172005974, 99.0888366417355],
    [101.552103099344, 101.138950287549],
    [104.212857069632, 100], 
    [108.203988025064, 97.9498863541865],
    [111.751687052037, 96.3553517806509],
    [114.855872950784, 94.7608224208239],
    [117.960099449414, 93.1662826335797],
    [120.620853419702, 92.0273375597393],
    [122.838134861648, 90.6605951291969],
    [125.055456903477, 89.0660553419528],
    [127.716210873765, 87.0159416961393],
    [129.490019787368, 85.6491992655969],
    [132.150773757656, 83.8268829764854],
    [134.811527727944, 82.0045562599565],
    [137.472281698232, 80.4100269001295],
    [138.802658683376, 79.0432844695872],
    [140.13303566852, 77.9043289683295]]

    NSF_TDS = [[2.21240596097333, 81.9186184211008],
    [9.95575086802917, 83.0627866325889],
    [16.5929181133819, 85.3511125804242],
    [23.2300853587347, 87.4106090760182],
    [33.1858362267639, 88.7836067397475],
    [46.4601707174694, 89.0124466671296],
    [56.4159215854986, 89.4701055716122],
    [70.7964843754746, 88.5547772875062],
    [79.6460069442333, 87.8682784556416],
    [91.8142144108034, 86.0376114122888],
    [106.194675925644, 85.1222831281829],
    [119.46901041635, 83.5204560122123],
    [134.955801505596, 82.147458348483],
    [144.911552373625, 81.0032901369949],
    [152.654846643114, 80.087961852889],
    [164.823054109684, 78.2572948095362],
    [178.097388600389, 76.8842971458069],
    [189.159266492554, 75.5112994820776],
    [199.115017360583, 74.8248006502129],
    [211.283224827153, 73.4518029864836],
    [219.026519096641, 72.0788053227542],
    [228.982269964671, 70.7058076590249],
    [240.04424913197, 69.3328099952956],
    [248.893771700729, 68.1886417838075],
    [262.168106191435, 66.8156441200782],
    [274.336313658005, 64.7561476244842],
    [283.185836226763, 64.0696487926195],
    [295.353942418199, 62.2389922244076],
    [305.309693286228, 60.8659945606783],
    [314.159317130121, 60.1794957288136],
    [323.00883969888, 58.5776581377022],
    [331.858362267639, 57.433500401355],
    [341.814113135668, 55.8316628102435],
    [355.088447626374, 54.2298356942729],
    [368.362782117079, 52.6280085783023],
    [378.318532985108, 50.7973415349496],
    [389.380512152408, 49.195514418979],
    [400.442491319708, 47.8225167552496],
    [413.716825810413, 45.9918497118969],
    [423.672576678443, 44.1611826685442],
    [434.734454570607, 42.5593555525736],
    [446.902662037177, 40.957528436603],
    [459.070768228612, 38.6691920136268],
    [472.345102719318, 37.0673648976563],
    [482.300853587347, 35.0078684020623],
    [494.468959778782, 33.6348707383329]]

    NSF_Turbidity = [[0.450464197107265, 97.6851889625984],
    [0.675675675675675, 95.8333337748491],
    [0.675675675675675, 93.7500006622737],
    [1.12613987278294, 92.1296339957307],
    [1.57658344990498, 89.814812361949],
    [2.25225912558065, 87.5000013245475],
    [3.37837837837837, 86.1111125828305],
    [3.603610476932, 84.0277794702551],
    [4.50451825116131, 82.6388907285382],
    [5.18019392683699, 80.5555576159628],
    [6.08108108108107, 78.9351909494197],
    [7.20722095386401, 77.5463022077028],
    [8.33334020666173, 75.6944470199535],
    [9.68469155801308, 74.3055582782365],
    [10.8108108108108, 73.1481474613457],
    [11.9369506835937, 71.2963028699765],
    [13.0630699363914, 70.1388920530857],
    [14.6396533862964, 67.8240810156842],
    [16.8918918918918, 65.2777814570764],
    [18.2432432432432, 63.6574147905334],
    [19.5945945945945, 62.5000039736425],
    [21.3964101430532, 60.6481487858932],
    [23.8738807472022, 57.8703713024593],
    [26.1261398727829, 55.7870381898839],
    [28.3783783783783, 54.6296379693732],
    [30.4054054054054, 52.5463048567978],
    [32.207220953864, 51.388894039907],
    [34.0090158823374, 50.00000529819],
    [35.8108108108108, 48.6111165564731],
    [37.6126263592694, 46.9907498899301],
    [39.1891891891891, 45.8333390730392],
    [41.4414483147698, 43.9814838852899],
    [43.9189189189189, 42.592595143573],
    [45.9459459459459, 40.7407505522038],
    [47.9729729729729, 39.8148176601391],
    [50.4504641971072, 38.6574174396284],
    [52.7027027027027, 36.8055622518791],
    [55.180193926837, 35.6481514349883],
    [56.7567567567567, 34.9537070641298],
    [58.5585723052153, 33.7963068436191],
    [60.8108108108108, 32.4074181019022],
    [62.8378378378378, 31.4814852098374],
    [65.0900969634185, 30.3240849893267],
    [66.8918918918919, 29.398152097262],
    [69.3693831160261, 28.4722298015774],
    [71.8468537201752, 27.777785430719],
    [74.3243243243243, 27.0833410598605],
    [77.027027027027, 25.6944523181435],
    [79.7297297297297, 24.768530022459],
    [82.207220953864, 24.0740856516005],
    [84.4594594594594, 23.379641280742],
    [87.1621621621621, 21.9907525390251],
    [89.1891891891892, 21.2963081681666],
    [90.5405405405405, 20.6018637973081],
    [92.1171239904455, 19.9074194264497],
    [94.1441510174725, 19.2129750555912],
    [97.2972972972973, 17.8240863138743],
    [99.3243243243243, 17.3611198678419]]

    NSF_Temp = [[-10.15432216503, 54.6583846516688],
    [-9.76851851851851, 56.3664613933244],
    [-9.38271840413411, 57.4534154426702],
    [-9.07407407407407, 58.6956537191588],
    [-8.61111111111111, 60.4037304608144],
    [-8.2253109967267, 62.2670843214819],
    [-7.68518518518518, 63.8198768359946],
    [-7.29938507080078, 65.3726693505073],
    [-6.83642210783781, 66.770184746008],
    [-6.45061846132631, 68.6335386066755],
    [-6.14197766339337, 70.1863382293191],
    [-5.60185185185185, 71.8944078628437],
    [-5.21605173746745, 73.6024846044993],
    [-4.83024809095594, 75.3105613461548],
    [-4.44444444444444, 77.018634533745],
    [-4.1358036465115, 78.2608692561682],
    [-3.67284068354854, 79.6583846516689],
    [-3.20987772058557, 81.5217385123364],
    [-2.74691475762261, 83.0745345809145],
    [-2.28395179465965, 84.9378884415821],
    [-1.97531099672671, 86.6459616291722],
    [-1.66666666666667, 88.0434770246729],
    [-1.12654438725224, 89.9068308853404],
    [-0.509259259259259, 92.0807460921629],
    [-0.123459144874855, 93.1677001415086],
    [0.108022336606625, 91.770184746008],
    [0.339503818088106, 91.1490691618291],
    [0.725310996726706, 90.2173922314953],
    [1.03394826253254, 88.5093154898397],
    [1.18827395968966, 87.577638559506],
    [1.65123692265263, 85.7142846988384],
    [1.95987418845847, 84.4720499764152],
    [2.26851851851851, 83.5403730460814],
    [2.65431863290291, 82.7639767888251],
    [2.88580011438439, 81.211180720247],
    [3.27160729302299, 79.9689459978237],
    [3.50308877450448, 78.7267077213351],
    [3.81172604031032, 77.1739152068224],
    [4.19753321894892, 75.7763998113217],
    [4.50617048475476, 75],        
    [4.73765196623624, 73.6024846044993],
    [4.89197766339336, 72.2049692089986],
    [5.20061492919921, 70.96273093251],
    [5.58642210783781, 68.9440999528304],
    [5.89505937364366, 67.7018616763417],
    [6.04938507080078, 66.3043462808411],
    [6.28086655228226, 64.7515537663284],
    [6.51234803376374, 63.1987612518157],
    [6.5895038180881, 61.8012458563151],
    [6.82098529956958, 60.5590075798264],
    [7.05246678105106, 59.1614921843257],
    [7.20679247820818, 57.6086996698131],
    [7.43827395968967, 56.3664613933244],
    [7.59259259259258, 54.8136688788117],
    [7.82407407407407, 53.5714306023231],
    [8.28703703703703, 51.7080767416555],
    [8.59568136709707, 50.1552842271428],
    [8.82716284857856, 48.2919303664753],
    [9.21296296296296, 46.8944149709746],
    [9.59876307734736, 45.6521766944859],
    [9.75308877450448, 43.7888228338184],
    [10.1388888888888, 42.2360303193057],
    [10.4475332189489, 40.5279535776502],
    [10.7561704847547, 39.1304381821495],
    [10.9876519662362, 37.5776456676368],
    [11.3734591448748, 36.1801302721362],
    [11.8364221078378, 35.2484533418024],
    [12.3765408551251, 33.8509379463017],
    [20.9413556699399, 18.9441070609613],      
    [21.6358001143844, 17.7018687844726],      
    [22.3302445588288, 16.9254689731508],      
    [22.9475332189489, 15.9937920428171],      
    [23.6419776633933, 15.5279535776502],      
    [24.6450593736436, 14.1304381821495],      
    [25.5709852995695, 13.3540454789586],      
    [26.1882739596896, 12.4223685486248],      
    [27.2685185185185, 11.1801231640053],      
    [28.0401258115415, 10.4037304608144],      
    [28.8117260403103, 9.62733775762354],      
    [29.5833333333333, 8.54037660014688]]

    NSF_Nitrates = [[0.590839682578426, 96.2852887822058],
    [1.32939435703847, 95.245168825003],
    [1.9202340396169, 94.3536384048059],
    [2.2156572617308, 93.3135218485217],
    [2.36336549196306, 92.4219914283246],
    [2.65878871407695, 90.9361062610232],
    [2.80649694430923, 89.5988106307275],
    [2.95421193619085, 88.8558697475362],
    [3.10192016642311, 87.5185741172405],
    [3.15192016642311, 85.2897480667477],
    [3.20192016642311, 83.9524524364521],
    [3.39734338853701, 82.0208020590521],
    [3.49734338853701, 80.8320959657622],
    [3.54505161876927, 79.4948003354666],
    [3.57505161876927, 78.1575047051709],
    [3.64505161876927, 75.7800891176724],
    [3.69275984900155, 74.294203950371],
    [3.77275984900155, 72.8083221839883],
    [3.79275984900155, 71.1738474796812],
    [4.13589130134771, 69.8365518493855],
    [4.4313145234616, 68.2020771450784],
    [4.87444597580776, 66.2704301685971],
    [5.16986919792165, 65.2303136123129],
    [5.31757742815391, 64.0416041181043],
    [5.61300065026781, 62.7043084878087],
    [5.90841711073235, 60.7726615113274],
    [6.35154856307851, 58.9896006709332],
    [6.64697178519241, 57.6523050406375],
    [7.23781146777083, 56.463595546429],
    [7.53323468988473, 55.5720651262319],
    [8.12407437246315, 54.5319485699477],      
    [8.86262904692321, 52.8974738656405],      
    [9.89660018184779, 51.708764371432],       
    [10.7828630865401, 49.7771173949507],      
    [11.6691259912324, 48.2912356285679],      
    [12.4076806656924, 46.6567609242608],      
    [13.2939435703848, 45.1708791578781],      
    [14.3279147053093, 43.8335835275824],      
    [15.3618926018833, 42.3476949593624],      
    [16.2481555065756, 41.0103993290667],      
    [17.4298348717325, 39.3759314265969],      
    [18.759229228771, 37.8900428583769],       
    [20.0886235858094, 36.5527472280812],      
    [20.9748864905018, 35.512630671797],       
    [21.7134479266112, 34.6211002515999],      
    [22.7474122998864, 33.5809836953157],      
    [23.4859737359958, 32.8380394112057],      
    [24.3722366406881, 31.9465089910086],      
    [25.7016309977266, 30.4606272246259],      
    [26.5878939024189, 29.7176829405158],      
    [27.6218582756942, 28.8261525203187],      
    [28.5081211803865, 27.6374430261102],      
    [29.5420990769604, 26.597326469826],       
    [30.4283619816528, 25.5572099135418],      
    [31.9054713305729, 24.5170865554203],      
    [32.9394357038481, 23.4769699991361],      
    [33.8256986085404, 22.7340257150261],      
    [35.007391496996, 21.6939091587419],       
    [35.5982244179251, 21.2481439486434],      
    [36.7799173063806, 19.9108483183477],      
    [38.1093116634191, 18.573552688052],       
    [38.9955745681114, 17.830608403942],       
    [39.7341224809221, 17.2362570577564],      
    [40.6203853856145, 16.6419057115708],      
    [41.9497797426529, 15.4531894155249],      
    [43.1314591078098, 14.2644867231536],
    [44.1654370043837, 13.3729563029565],      
    [45.3471163695406, 12.6300188206838],      
    [46.2333792742329, 11.8870677347365],      
    [47.4150721626885, 10.8469579802896],      
    [48.4490365359637, 10.1040068943423],      
    [49.4830144325377, 9.36106941206958],      
    [50.6646937976945, 9.06389713989542],      
    [52.1418031466146, 8.17236671969832],      
    [53.6189124955347, 7.72660150959977],      
    [55.6868547653839, 7.28083629950122],      
    [57.3116655828869, 6.83507108940266],      
    [59.5273228446177, 6.24071294137972],      
    [61.8906950982302, 5.94354066920556],      
    [63.6632209076148, 5.49777545910701],      
    [65.8788781693456, 4.90341731108407],      
    [67.9468204391948, 4.60624503890991],      
    [69.7193462485794, 4.30905916306112],      
    [71.3441705893811, 4.30905916306112],      
    [73.7075293196949, 4.30905916306112],      
    [75.6277701209611, 3.86329395296257],      
    [77.2525809384641, 3.86329395296257],      
    [79.0251067478488, 3.7147146187128],       
    [80.7976325572334, 3.7147146187128],       
    [82.7178733584997, 3.7147146187128],       
    [84.3426841760027, 3.7147146187128],       
    [85.6720785330412, 3.56612168078841],      
    [87.2969028738429, 3.56612168078841],      
    [88.921713691346, 3.41752874286402],       
    [89.8079765960383, 3.41752874286402],      
    [90.9896559611951, 3.26894940861425],      
    [92.3190503182336, 2.97176353276547],      
    [93.3530282148076, 2.8231841985157],       
    [94.8301375637276, 2.8231841985157],
    [96.3072333893491, 2.8231841985157],       
    [96.7503648416952, 2.8231841985157],       
    [98.0797591987337, 2.8231841985157],       
    [99.4091535557722, 2.8231841985157]]

    NSF_P = [[0.0337270692635022, 96.7741924202111],
    [0.0843172871860224, 94.7368410826475],
    [0.185497723031062, 93.0390470060314],
    [0.20236087169008, 91.1714762419112],
    [0.21236087169008, 89.303905477791],
    [0.236087940953583, 87.4363308277315],
    [0.252951089612601, 86.0780978980021],
    [0.26981423827162, 84.7198649682728],
    [0.286678158876103, 83.3616281526042],
    [0.303541307535122, 81.6638379619274],
    [0.32040445619414, 79.9660438853113],
    [0.354131525457643, 77.9286886618084],
    [0.370994674116661, 76.0611217836274],
    [0.404721743380163, 74.363323821072],
    [0.438448812643664, 72.3259724835084],
    [0.472175109961701, 70.1188444584407],
    [0.475175109961701, 68.0814931208771],
    [0.482175109961701, 66.3837029302003],
    [0.489039030566184, 64.8556894270275],
    [0.505902179225203, 62.8183380894639],
    [0.515902179225203, 61.6298779612994],
    [0.539629248488704, 59.7623110831185],
    [0.590219466411224, 57.5551752861722],
    [0.607082615070244, 55.5178239486086],
    [0.640809684333745, 53.4804726110449],
    [0.691399902256266, 51.612905732864],
    [0.725126199574303, 49.7453310828045],
    [0.758853268837805, 47.5382030577368],
    [0.792580338101306, 45.6706284076773],
    [0.843170556023826, 43.6332770701136],
    [0.910623922605365, 41.9354868794368],     
    [0.961214140527886, 40.2376889168814],     
    [1.0118043584504, 38.5398987262046],       
    [1.11298479429544, 36.3327707011369],      
    [1.21416523014048, 34.4651960510774],      
    [1.2984825173265, 32.5976214010178],       
    [1.43338925048958, 30.7300545228369],      
    [1.51770730962107, 29.0322565602815],      
    [1.68634034010218, 27.6740275164915],      
    [1.83811099386975, 26.6553518477097],      
    [1.98988164763731, 25.2971150320411],      
    [2.19224251932739, 23.7691015288684],      
    [2.42833123222643, 22.7504258600866],      
    [2.66441840123455, 21.7317501913048],      
    [2.90050557024267, 20.203736688132],       
    [3.11973036253724, 19.0152843318461],      
    [3.32209123422732, 18.3361620380725],      
    [3.55817840323544, 16.9779329942825],      
    [3.76053927492552, 15.789472866118],       
    [3.94603776990204, 15.2801350317271],      
    [4.16526101830568, 14.6010205098321],      
    [4.35075951328221, 13.7521215285544],      
    [4.58684668229032, 13.0729992347808],      
    [4.77234363337592, 12.5636614003899],      
    [4.974704505066, 11.7147701909908],        
    [5.12647515883357, 11.3752168159826],      
    [5.32883603052365, 10.8658789815916],      
    [5.53119690221373, 10.0169722284354],      
    [5.71669539719026, 9.16808101903628],      
    [5.88532842767137, 8.82852764402808],      
    [6.13827951728397, 8.31918980963716],      
    [6.34064038897405, 7.9796208908718],       
    [6.52613888395058, 7.9796208908718],       
    [6.72849975564066, 7.47028305648088],      
    [6.99831322196682, 7.47028305648088],      
    [7.18381171694334, 7.30051414085536],      
    [7.38617258863342, 7.13072968147268],      
    [7.63912367824602, 6.62139184708176],      
    [7.82462062933162, 6.45160738769908],      
    [8.04384542162619, 6.28183847207354],      
    [8.27993259063431, 6.11205401269086],      
    [8.51601975964243, 6.11205401269086],      
    [8.70151825461895, 5.60271617829996],      
    [8.92074150302259, 5.60271617829996],      
    [9.17369259263519, 5.43293171891728],      
    [9.35919108761172, 5.43293171891728],      
    [9.54468803869731, 5.26316280329174],
    [9.73018498978291, 5.26316280329174],      
    [9.89881956415496, 5.26316280329174]]

    NSF_FC = [[1.0187424272701804, 95.9055129633086],
    [1.1601546527771303, 95.118108976086],
    [1.2968895333347896, 93.8582676427437],
    [1.4497398753237059, 92.7559042232952],
    [1.6509805092431236, 91.6535444082851],
    [1.8116082205700108, 90.8661404210625],
    [1.987865463102157, 90.0787400382784],
    [2.222153664258209, 88.6614171866039],
    [2.4840548815965877, 87.4015758532615],
    [2.828867976334629, 86.1417309154808],
    [3.1622760473461864, 84.5669301499125],
    [3.601236475508544, 83.3070852121318],
    [4.025675267491873, 82.0472438787895],
    [4.417342522884801, 80.629921027115],
    [4.757944679310574, 79.3700796937726],
    [5.12480919333276, 77.7952753237659],
    [5.836181960387393, 76.3779524720914],
    [6.524029603247867, 74.9606296204169],
    [7.292946407933654, 73.5433067687424],
    [8.002507632297467, 72.2834654354001],
    [9.113332598262911, 70.8661425837256],
    [10.187422540774286, 69.6062976459448],
    [11.819005753538404, 68.0314968803765],
    [13.211984125992423, 66.614174028702],
    [15.045934493981854, 64.8818881403631],
    [16.509816319526745, 64.0944841531406],
    [18.45564979705121, 62.8346464242367],
    [20.630817620214433, 61.5748014864559],
    [23.494573374513756, 59.6850376842232],
    [26.26362461817921, 58.110236918655],
    [29.909318964555926, 56.6929140669804],    
    [34.061077780723394, 55.2755912153059],    
    [40.256780050554454, 53.3858274130732],    
    [45.00141129318435, 51.8110194386281],     
    [50.305240901909855, 50.2362186730598],    
    [58.36185929142489, 48.8188958213853],     
    [64.04001953273547, 47.4015729697108],     
    [74.29645293348023, 45.8267722041425],     
    [86.19537555561588, 44.0944863158036],     
    [99.9999659987195, 42.5196855502353],      
    [111.78588037993988, 41.1023626985608],    
    [137.11883840597795, 39.0551137735575],    
    [156.1522509316712, 37.4803130079892],     
    [174.55622778841402, 36.0629901563147],    
    [202.51256412403845, 34.3307042679758],    
    [230.62325423357103, 32.4409404657431],    
    [257.8043227626289, 30.8661397001748],     
    [288.1889298456726, 29.4488168485003],     
    [328.1928808425765, 28.0314939968258],     
    [373.74984213802793, 26.4566932312575],    
    [441.73485307018643, 25.3543262073706],    
    [551.9959164781585, 24.4094443062542],     
    [652.4038476269554, 22.9921214545797],     
    [815.2498207505018, 21.8897616395696],     
    [981.6018879869724, 20.7874018245595],     
    [1204.0528750180317, 19.2125938501144],    
    [1423.0698180158447, 18.1102340351042],    
    [1778.2810727938006, 16.8503890973235],    
    [2181.2720863835975, 16.0629923189778],    
    [2725.7375686863224, 15.1181104178614],    
    [3343.4395520173116, 14.0157433939745],    
    [4101.131073933798, 12.9133835789643],     
    [4937.968586548604, 12.4409354195294],     
    [5836.183944764552, 11.496053518413],      
    [7158.782133394902, 10.2362157895091],     
    [9113.335696913686, 9.44881901116341],     
    [10378.371917537545, 8.66140781506405],    
    [12730.300801248553, 8.0314961594889],     
    [15045.939609793993, 7.8740110367183],     
    [18801.543881944166, 7.8740110367183],     
    [23062.356789327067, 7.24408496338953],    
    [26755.900533143908, 7.08661425837256],    
    [32819.27692527948, 6.61417330781439],     
    [39516.13130190049, 5.82676211171502],     
    [45844.82358965277, 5.03936533336928],
    [53187.175814823684, 4.7244095055817],     
    [62861.91094925485, 4.40943926004051],     
    [71587.74831164764, 4.09448343225294],     
    [86195.40486315521, 3.77952760446536],     
    [100000, 3]]

    NSF_S = [NSF_pH, NSF_BOD, NSF_DO, NSF_TDS, NSF_Turbidity, NSF_Temp, NSF_Nitrates, NSF_P, NSF_FC]
    
    if Opt == '1':
        numbers = int(input('Enter Numbers of Tests You Had Done: '))
        for i in range (p):
            print('Enter The value of ' + Para_NSF[i] + ':')
            for j in range(numbers):
                In = input(str(j + 1) + ':')
                try:
                    Vn_NSF[i][j] = float(In)
                except ValueError:
                    break
           


    NSF_Y = [[-1.0] * nsf_num for _ in range(p)]

    # print(NSF_S)
    Qi = ['Qi']
    NSFWqi = ['NSFWQI']
    WQ = ['Water Quality']

    for i in range(p):
        if Vn_NSF[i][0] != -1:
            for j in range(nsf_num):
                x = Vn_NSF[i][j]
                for k in range(len(NSF_S[i])):
                    x2 = NSF_S[i][k][0]
                    if x < x2:
                        x1 = NSF_S[i][k-1][0]
                        y1 = NSF_S[i][k-1][1]
                        y2 = NSF_S[i][k][1]
                        d = (y2-y1)/(x2-x1)
                        NSF_Y[i][j] = y1 + d*(x-x1)
                        Qi.append (str(NSF_Y[i][j]))
                        NSFWqi.append("")
                        WQ.append("")
                        break
    #print ("Qi =" +str (NSF_Y))               
    nsfwqi = 0

    for i in range (p):
        nsF = 0
        if  NSF_Y[i][0] != -1:
            for j in range (nsf_num):
                nsF += NSF_Y[i][j]
            R = nsF / nsf_num 
            nsfwqi += R*Wi[i]
            
    e = math.ceil(len(Qi)/2)
    NSFWqi[e] = str(nsfwqi)
    #print("NSFWQI =" +str (nsfwqi))

    if nsfwqi >= 91 and nsfwqi <= 100:
        WQ[e] = 'Excellent'
        #print ("The Quality of the water is Excellent ")
    elif nsfwqi >= 71 and nsfwqi < 91:
        WQ[e] = 'Good' 
        #print ("The Quality of the water is Good ")
    elif nsfwqi >= 51 and nsfwqi < 71:
        WQ[e] = 'Moderate'
        #print ("The Quality of the water is Moderate ")
    elif nsfwqi >= 26 and nsfwqi <= 51:
        WQ[e] = 'Poor'
        #print("The Quality of the water is Poor")
    else:
        WQ[e] = 'Very poor'
        #print("The Quality of the water is Very Poor")
    
    Output = list(zip(Qi, NSFWqi, WQ))
    return Output



wqi = WQI()
for i in wqi:
    table = tabulate(i, headers="firstrow", tablefmt="fancy_grid")
    print(table)
cwqi = CWQI()
table = tabulate(cwqi, headers="firstrow", tablefmt="fancy_grid")
print(table)

nsf = NSF()
table = tabulate(nsf, headers="firstrow", tablefmt="fancy_grid")
print(table)
end = input()